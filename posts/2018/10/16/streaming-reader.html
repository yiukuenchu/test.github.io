<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>StreamingReaderæµå¼è¯»å–å¤§æ•°æ®é‡æ–‡ä»¶ | Yiu Kuen Chu</title>
    <meta name="description" content="(à¸…Â´Ï‰&#96;à¸…) æ‘¸é±¼å•¦å–‚">
    <link rel="icon" href="/favicon.png">
    
    <link rel="preload" href="/assets/css/0.styles.0a48aea5.css" as="style"><link rel="preload" href="/assets/js/app.b98814d5.js" as="script"><link rel="preload" href="/assets/js/3.fa9fe6dd.js" as="script"><link rel="preload" href="/assets/js/19.8ea87ca2.js" as="script"><link rel="prefetch" href="/assets/js/1.784d45c1.js"><link rel="prefetch" href="/assets/js/10.5e12d166.js"><link rel="prefetch" href="/assets/js/11.fbbf814e.js"><link rel="prefetch" href="/assets/js/12.e007a695.js"><link rel="prefetch" href="/assets/js/13.ecb30846.js"><link rel="prefetch" href="/assets/js/14.28166d4a.js"><link rel="prefetch" href="/assets/js/15.8130288b.js"><link rel="prefetch" href="/assets/js/16.96d9a70e.js"><link rel="prefetch" href="/assets/js/17.e017449e.js"><link rel="prefetch" href="/assets/js/18.1fa90e46.js"><link rel="prefetch" href="/assets/js/20.d8cddda9.js"><link rel="prefetch" href="/assets/js/21.614e9d0e.js"><link rel="prefetch" href="/assets/js/22.6d01a4aa.js"><link rel="prefetch" href="/assets/js/23.da1d37dc.js"><link rel="prefetch" href="/assets/js/24.e105b560.js"><link rel="prefetch" href="/assets/js/4.91faec4f.js"><link rel="prefetch" href="/assets/js/5.f61fcb8e.js"><link rel="prefetch" href="/assets/js/6.4b251023.js"><link rel="prefetch" href="/assets/js/7.175f1a38.js"><link rel="prefetch" href="/assets/js/8.e0564248.js"><link rel="prefetch" href="/assets/js/9.ce1f6d6a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0a48aea5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-meteorlxy"><header class="header" data-v-0539f1bd><div data-v-39c72c19 data-v-0539f1bd><nav class="navbar" data-v-39c72c19><div class="container" data-v-39c72c19><a href="/" class="router-link-active" data-v-39c72c19><span class="navbar-site-name" data-v-39c72c19>
          Yiu Kuen Chu
        </span></a> <div class="navbar-toggler" data-v-39c72c19><svg class="icon" style="font-size:1.2em;" data-v-39c72c19 data-v-39c72c19><title data-v-39c72c19 data-v-39c72c19>menu</title><use xlink:href="#icon-menu" data-v-39c72c19 data-v-39c72c19></use></svg></div> <div class="navbar-links" data-v-39c72c19><a href="/" class="navbar-link" data-v-39c72c19>
            Home
          </a><a href="/posts/" class="navbar-link router-link-active" data-v-39c72c19>
            Posts
          </a><a href="/about/" class="navbar-link" data-v-39c72c19>
            About
          </a><a href="https://github.com/yiukuenchu" target="_blank" rel="noopener noreferrer" class="navbar-link" data-v-39c72c19>
            GitHub
          </a></div></div></nav> <div class="navbar-holder" style="display:none;" data-v-39c72c19></div></div> <div class="banner" data-v-98d6aa8c data-v-0539f1bd data-v-0539f1bd><div class="container" data-v-98d6aa8c><div class="center" data-v-98d6aa8c><h1 data-v-98d6aa8c data-v-0539f1bd>
          StreamingReaderæµå¼è¯»å–å¤§æ•°æ®é‡æ–‡ä»¶
        </h1></div></div></div></header> <div class="container clearfix show-aside" data-v-6cd81e6a data-v-6cd81e6a><main class="main" data-v-6cd81e6a><div class="post" data-v-6cd81e6a data-v-6cd81e6a><section class="post-meta main-div" data-v-4e23451f><section class="post-date clearfix" data-v-4e23451f><span class="create-date" data-v-4e23451f>
      Created : 2018-10-16
    </span> <!----></section> <section class="post-links" data-v-4e23451f><a href="/posts/2018/10/14/find-a-number.html" class="post-link" data-v-4e23451f>
      Previous Post : å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯å¦åœ¨40äº¿ä¸ªæ•´æ•°ä¸­ï¼Ÿ
    </a> <a href="/posts/2018/10/20/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F.html" class="post-link" data-v-4e23451f>
      Next Post : å…³äºæ­£åˆ™è¡¨è¾¾å¼çš„ä¸€äº›ç†è§£
    </a></section></section> <article class="main-div"><div class="content default"><h1 id="å‰è¨€"><a href="#å‰è¨€" aria-hidden="true" class="header-anchor">#</a> å‰è¨€</h1> <p>å‰ä¸€æ®µæ—¶é—´åœ¨ä¸€ä¸ªå·¥ä½œé¡¹ç›®ä¸­ï¼Œæœ‰ä¸€ä¸ªæˆ‘è´Ÿè´£çš„åŠŸèƒ½æ¨¡å—æ˜¯éœ€è¦è¯»å–Excelæ–‡ä»¶ä¸­çš„æ•°æ®ã€‚æ¶‰åŠåˆ°Javaå¯¹Excelè¯»å†™ï¼Œæœ‰ä¸¤ç§å¸¸è§çš„Excelæ“ä½œæ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯<a href="https://www.cnblogs.com/puresoul/p/3502139.html" target="_blank" rel="noopener noreferrer">JXL<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>å’Œ<a href="https://blog.csdn.net/wwd0501/article/details/78780646" target="_blank" rel="noopener noreferrer">POI<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚è¿™æ˜¯å®ƒä»¬ä¹‹é—´çš„<a href="https://www.cnblogs.com/jyh317/p/4065959.html" target="_blank" rel="noopener noreferrer">åŒºåˆ«<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚</p> <h2 id="poi"><a href="#poi" aria-hidden="true" class="header-anchor">#</a> POI</h2> <p>è€ƒè™‘åˆ° <strong>æ•°æ®é‡å¤§</strong> çš„é—®é¢˜ï¼Œæˆ‘é€‰æ‹©äº†æ•ˆç‡è¾ƒé«˜çš„POIã€‚ç®€æ˜“ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>//è·å–workbookå¯¹è±¡
InputStream is = new FileInputStream(file);
Workbook wb = new Workbook(is);

ArrayList&lt;String&gt; sheetNames = new ArrayList&lt;String&gt;();

//éå†sheetåï¼Œå­˜åœ¨sheetNamesä¸­
for(Sheet sheet : wb){
	String name = sheet.getSheetName();
	sheetNames.add(name);
}

wb.close();
</code></pre></div><p>è¿™é‡Œåªå†™äº†éå†sheetåï¼Œå°±ä¸å†™å¦‚ä½•éå†å•å…ƒæ ¼äº†ï¼ˆæ‰ä¸æ˜¯æˆ‘æ‡’å’§ğŸ˜…ï½ï¼‰ï¼Œæƒ³è¦äº†è§£çš„å°å¯çˆ±ä»¬å¯ä»¥ç‚¹å‡»ä¸Šé¢çš„POIé“¾æ¥å‚è€ƒã€‚</p> <p>æœ‰çš„äººä¼šè¯´ï¼Œçœ‹ä¸Šå»ä¼¼ä¹æ²¡æœ‰é—®é¢˜è¯¶ï½ï¼ˆæˆ‘å½“æ—¶ä¹Ÿæ˜¯è¿™ä¹ˆæƒ³çš„ï¼Œå¤ªç®€å•äº†ï¼ï¼‰</p> <p>ä½†æ˜¯ä»£ç ä¸€è·‘èµ·æ¥ï¼Œå®Œäº†ï¼Œæ˜¯è®¨äººåŒçš„Out of Memoryå¼‚å¸¸è¯¶ï½åˆ†æè¿‡åï¼Œåˆæ­¥ç¡®è®¤æ˜¯Excelæ–‡ä»¶ä¸­çš„æ•°æ®é‡å¤ªå¤§ï¼Œå“ªæ€•æ˜¯ç©ºè¡Œï¼ŒPOIä¹Ÿä¼šæŠŠè¿™äº›ç©ºè¡Œæ•°æ®è¯»å…¥å†…å­˜ï¼Œæœ€ç»ˆå¯¼è‡´å†…å­˜æº¢å‡ºã€‚</p> <h2 id="ä¿®æ”¹run-configurations"><a href="#ä¿®æ”¹run-configurations" aria-hidden="true" class="header-anchor">#</a> ä¿®æ”¹Run Configurations</h2> <p>æŸ¥äº†ä¸€ä¸‹èµ„æ–™ï¼Œæœ‰äººæå‡ºé€šè¿‡ä¿®æ”¹è¿è¡Œå†…å­˜ï¼ˆè°ƒè¯•å†…å­˜ï¼‰çš„æ–¹æ³•ï¼Œè§£å†³å†…å­˜æº¢å‡ºé—®é¢˜ã€‚å‚æ•°ä¸ºï¼š</p> <blockquote><p>-Xms1000M -Xmx1000M</p></blockquote> <p><img src="https://ws2.sinaimg.cn/large/006tNbRwgy1fwa0hms8iuj30k20eeq2y.jpg" alt=""></p> <p>æ»¡æ€€æœŸå¾…çš„ç‚¹äº†Debugï¼Œå¯æ˜¯ç»“æœè¿˜æ˜¯åŒæ ·å†…å­˜æº¢å‡ºã€‚</p> <h1 id="ğŸŒŸstreamingreader"><a href="#ğŸŒŸstreamingreader" aria-hidden="true" class="header-anchor">#</a> ğŸŒŸStreamingReader</h1> <p>æ‰¾äº†å¾ˆå¤šæ–¹æ³•åï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯è®²POIè¯»å–çš„å®ç°ï¼Œæ²¡å•¥å®é™…å¸®åŠ©å˜›ç®€ç›´ï¼ğŸ˜ <br>
æœ€ç»ˆåœ¨stackoverflowä¸Šæ‰¾åˆ°äº†ä¸€ä¸ªä¸åŒçš„è§£å†³åŠæ³•ï¼ŒğŸ‘‰<a href="https://stackoverflow.com/questions/48337588/poi-streamingreader" target="_blank" rel="noopener noreferrer">ä½¿ç”¨StreamingReader<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚</p> <h2 id="å®ç°"><a href="#å®ç°" aria-hidden="true" class="header-anchor">#</a> å®ç°</h2> <p>è¦åœ¨pom.xmlä¸­æ·»åŠ ä¾èµ–ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;dependency&gt;
	&lt;groupId&gt;com.monitorjbl&lt;/groupId&gt;
	&lt;artifactId&gt;xlsx-streamer&lt;/artifactId&gt;
	&lt;version&gt;1.2.0&lt;/version&gt;
&lt;/dependency&gt;
</code></pre></div><p>å®ç°ä»£ç ä¸ºï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>InputStream is = new FileInputStream(file);
Workbook wb= StreamingReader.builder()
	.rowCacheSize(100)	//è®¾ç½®ç¼“å­˜çš„è¡Œæ•°ï¼Œé»˜è®¤æ˜¯10
	.bufferSize(4096)	//è®¾ç½®ç¼“å­˜åˆ°å†…å­˜çš„å­—èŠ‚å¤§å°ï¼Œé»˜è®¤æ˜¯1024
	.open(is);	//æ‰“å¼€èµ„æº
</code></pre></div><p>å…¶ä»–ä»£ç åˆ™æ˜¯ç›¸åŒçš„äº†ã€‚</p> <h2 id="åŸç†"><a href="#åŸç†" aria-hidden="true" class="header-anchor">#</a> åŸç†</h2> <p>æŠŠä¸€éƒ¨åˆ†çš„è¡Œå…ˆç¼“å­˜åˆ°å†…å­˜ä¸­ï¼Œå¦‚ä¸Šé¢ä»£ç æˆ‘è®¾ç½®ä¸ºç¼“å­˜100è¡Œï¼›è¿™æ ·å°±é¿å…äº†ä¸€æ¬¡æ€§åŠ è½½æ‰€æœ‰çš„è¡Œæ•°æ®åˆ°å†…å­˜ä¸­å¼•èµ·å†…å­˜æº¢å‡ºã€‚é€šè¿‡è¿™ç§ <strong>æµå¼è¯»å–</strong>çš„æ–¹å¼ï¼Œè¯»å–å¤§æ•°æ®é‡å¤§Excelæ–‡ä»¶æ—¶å°±ä¸ä¼šæŠ¥out of memoryå•¦ï¼</p> <h1 id="ç»“è¯­"><a href="#ç»“è¯­" aria-hidden="true" class="header-anchor">#</a> ç»“è¯­</h1> <p>è¿™ç§æ–¹å¼è¯»å–é€Ÿåº¦ä¹Ÿæ˜¯éå¸¸å¿«ï¼Œåå‡ ä¸‡è¡Œé“æ•°æ®ï¼Œåœ¨å‡ ç§’é’Ÿä¹‹å†…å°±èƒ½è¯»å–äº†å‡ºæ¥ã€‚ğŸ˜„</p> <p>ä½ ä¹Ÿè¯•è¯•ï¼Ÿ</p></div></article> <section class="post-meta main-div" data-v-4e23451f><section class="post-date clearfix" data-v-4e23451f><span class="create-date" data-v-4e23451f>
      Created : 2018-10-16
    </span> <!----></section> <section class="post-links" data-v-4e23451f><a href="/posts/2018/10/14/find-a-number.html" class="post-link" data-v-4e23451f>
      Previous Post : å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯å¦åœ¨40äº¿ä¸ªæ•´æ•°ä¸­ï¼Ÿ
    </a> <a href="/posts/2018/10/20/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F.html" class="post-link" data-v-4e23451f>
      Next Post : å…³äºæ­£åˆ™è¡¨è¾¾å¼çš„ä¸€äº›ç†è§£
    </a></section></section> <div id="post-comments" class="main-div"><!----></div></div></main> <aside class="aside" data-v-6cd81e6a><div class="info-card main-div" data-v-3da8ff8d data-v-6cd81e6a><div class="info-card-header" data-v-3da8ff8d><img src="/avatar.jpg" alt="yiukuenchu" class="info-avatar" data-v-3da8ff8d></div> <div class="info-card-body" data-v-3da8ff8d><section class="info-nickname" data-v-3da8ff8d>
      yiukuenchu
    </section> <section class="info-desc" data-v-3da8ff8d>çœŸè¯šæ‰æ˜¯æœ€å¤§æœ¬é¢†</section> <section class="info-contact" data-v-3da8ff8d><section data-v-3da8ff8d><span title="Shenzhen, China" data-v-3da8ff8d data-v-3da8ff8d><svg class="icon" style="font-size:1em;" data-v-3da8ff8d data-v-3da8ff8d><title data-v-3da8ff8d data-v-3da8ff8d>Shenzhen, China</title><use xlink:href="#icon-location" data-v-3da8ff8d data-v-3da8ff8d></use></svg><span class="info-text" data-v-3da8ff8d data-v-3da8ff8d>
          Shenzhen, China
        </span></span></section> <section data-v-3da8ff8d><span title="Sichuan University" data-v-3da8ff8d data-v-3da8ff8d><svg class="icon" style="font-size:1em;" data-v-3da8ff8d data-v-3da8ff8d><title data-v-3da8ff8d data-v-3da8ff8d>Sichuan University</title><use xlink:href="#icon-organization" data-v-3da8ff8d data-v-3da8ff8d></use></svg><span class="info-text" data-v-3da8ff8d data-v-3da8ff8d>
          Sichuan University
        </span></span></section> <section data-v-3da8ff8d><a href="mailto:yiukuenchu@gmail.com" title="yiukuenchu@gmail.com" data-v-3da8ff8d data-v-3da8ff8d><svg class="icon" style="font-size:1em;" data-v-3da8ff8d data-v-3da8ff8d><title data-v-3da8ff8d data-v-3da8ff8d>yiukuenchu@gmail.com</title><use xlink:href="#icon-email" data-v-3da8ff8d data-v-3da8ff8d></use></svg><span class="info-text" data-v-3da8ff8d data-v-3da8ff8d>
          yiukuenchu@gmail.com
        </span></a></section></section></div> <div class="info-card-footer" data-v-3da8ff8d><section class="info-sns clearfix" data-v-3da8ff8d><a href="https://github.com/yiukuenchu" target="_blank" class="sns-link" data-v-3da8ff8d><span title="GitHub: @yiukuenchu" class="sns-icon" data-v-3da8ff8d data-v-3da8ff8d><svg class="icon" style="font-size:1.5em;" data-v-3da8ff8d data-v-3da8ff8d><title data-v-3da8ff8d data-v-3da8ff8d>GitHub: @yiukuenchu</title><use xlink:href="#icon-github" data-v-3da8ff8d data-v-3da8ff8d></use></svg></span></a><a href="https://twitter.com/yiukuenchu" target="_blank" class="sns-link" data-v-3da8ff8d><span title="Twitter: @yiukuenchu" class="sns-icon" data-v-3da8ff8d data-v-3da8ff8d><svg class="icon" style="font-size:1.5em;" data-v-3da8ff8d data-v-3da8ff8d><title data-v-3da8ff8d data-v-3da8ff8d>Twitter: @yiukuenchu</title><use xlink:href="#icon-twitter" data-v-3da8ff8d data-v-3da8ff8d></use></svg></span></a><a href="https://www.instagram.com/yiukuenchu/" target="_blank" class="sns-link" data-v-3da8ff8d><span title="Instagram: @yiukuenchu" class="sns-icon" data-v-3da8ff8d data-v-3da8ff8d><svg class="icon" style="font-size:1.5em;" data-v-3da8ff8d data-v-3da8ff8d><title data-v-3da8ff8d data-v-3da8ff8d>Instagram: @yiukuenchu</title><use xlink:href="#icon-instagram" data-v-3da8ff8d data-v-3da8ff8d></use></svg></span></a></section></div></div> <div class="post-nav-card main-div" style="position:relative;top:0;width:0px;" data-v-6cd81e6a><div class="post-nav-contents"><svg class="icon"><title>book</title><use xlink:href="#icon-book"></use></svg> <span>Table of Contents</span> <div class="post-nav-toc"> <ul><li><a href="/posts/2018/10/16/streaming-reader.html#poi">POI</a> <!----></li><li><a href="/posts/2018/10/16/streaming-reader.html#ä¿®æ”¹run-configurations">ä¿®æ”¹Run Configurations</a> <!----></li><li><a href="/posts/2018/10/16/streaming-reader.html#å®ç°">å®ç°</a> <!----></li><li><a href="/posts/2018/10/16/streaming-reader.html#åŸç†">åŸç†</a> <!----></li></ul> </div></div> <div class="post-nav-comments"><svg class="icon"><title>comment</title><use xlink:href="#icon-comment"></use></svg> <a href="/posts/2018/10/16/streaming-reader.html#post-comments">
      Comments
    </a></div></div></aside></div> <footer class="footer" data-v-1114308c><p class="sns-links" data-v-1114308c><a href="https://github.com/yiukuenchu" target="_blank" class="sns-link" data-v-1114308c><span title="GitHub: @yiukuenchu" class="sns-icon" data-v-1114308c data-v-1114308c><svg class="icon" style="font-size:25px;" data-v-1114308c data-v-1114308c><title data-v-1114308c data-v-1114308c>GitHub: @yiukuenchu</title><use xlink:href="#icon-github" data-v-1114308c data-v-1114308c></use></svg></span></a><a href="https://twitter.com/yiukuenchu" target="_blank" class="sns-link" data-v-1114308c><span title="Twitter: @yiukuenchu" class="sns-icon" data-v-1114308c data-v-1114308c><svg class="icon" style="font-size:25px;" data-v-1114308c data-v-1114308c><title data-v-1114308c data-v-1114308c>Twitter: @yiukuenchu</title><use xlink:href="#icon-twitter" data-v-1114308c data-v-1114308c></use></svg></span></a><a href="https://www.instagram.com/yiukuenchu/" target="_blank" class="sns-link" data-v-1114308c><span title="Instagram: @yiukuenchu" class="sns-icon" data-v-1114308c data-v-1114308c><svg class="icon" style="font-size:25px;" data-v-1114308c data-v-1114308c><title data-v-1114308c data-v-1114308c>Instagram: @yiukuenchu</title><use xlink:href="#icon-instagram" data-v-1114308c data-v-1114308c></use></svg></span></a></p> <p data-v-1114308c><span data-v-1114308c>Powered by </span> <a href="https://vuepress.vuejs.org" target="_blank" data-v-1114308c>
      Vuepress
    </a></p></footer></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.b98814d5.js" defer></script><script src="/assets/js/3.fa9fe6dd.js" defer></script><script src="/assets/js/19.8ea87ca2.js" defer></script>
  </body>
</html>
